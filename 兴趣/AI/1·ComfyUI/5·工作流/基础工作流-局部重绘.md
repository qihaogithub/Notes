
**前言：** 

1.  我们上一节讲了图生图，也提到了“遮罩”这个节点；
2.  我们想一下在使用 Web UI 进行局部重绘的时候都用到了那些功能？

上期回顾：

**内容补充：** 

在开始之前我先给大家补充个知识点，怎么在图生图的时候批量出图“右键\-新建节点\- Latent-批处理-复制 Latent 批次”，把“复制 Latent 批次”节点串联在“VAE 编码”和“K 采样器”之间，然后设置次数就可以了。

![](https://image.uisdc.com/wp-content/uploads/2023/12/uisdc-sd-20231227-2.jpg)

①我们打开上节课“图生图”的流程图，我们可以看到“加载图像”节点是没有地方连接的，点住“遮罩”往外拉，松开然后选择“VAE 内补编码器”；

②我们会看到刚才添加的“VAE 内补编码器”和“VAE 编码器”相比多了遮罩、遮罩延展：

1.  遮罩：用来连接“加载图像”的遮罩；
2.  遮罩延展：类似于羽化（根据你的图像大小适当调整）。

![](https://image.uisdc.com/wp-content/uploads/2023/12/uisdc-sd-20231227-3.jpg)

③有了“VAE 内补编码器”我们就不再需要“VAE 编码”了，并且“图像缩放”节点也可以删掉了（如果你图像太大还是建议保留这个节点）；

④我们把“VAE 内补编码器”节点的“图像、遮罩”与“加载图像”节点的“图像、遮罩”连接，“VAE”与“VAE 加载器”连接，“Latent”与“K 采样器”连接。

![](https://image.uisdc.com/wp-content/uploads/2023/12/uisdc-sd-20231227-4.jpg)

⑤在“加载图像”节点上面“右键-在遮罩编辑器打开”，我们就可以看到一个绘制重绘区域的弹窗。下方有三个按钮和一个滑块，分别是清除（清除绘制区域）、取消（关闭弹窗）、Stave to node（把重绘图像同步到节点）、滑块（调整画笔大小）

![](https://image.uisdc.com/wp-content/uploads/2023/12/uisdc-sd-20231227-5.jpg)

⑥我们输入想要重绘的关键词就可以出图了，我演示中是把小猫重绘成了小狗

![](https://image.uisdc.com/wp-content/uploads/2023/12/uisdc-sd-20231227-6.jpg)

![](https://image.uisdc.com/wp-content/uploads/2023/12/uisdc-sd-20231227-7.jpg)

⑦这个流程不止还可以进行修复，还可以更模型，绘制成不同的风格

1\. 我们可以通过对图像四周进行重绘进行扩图，这时候我们就用到一个“外补画板”节点，“右键-新建节点-图像-外补画板”；

2\. 上下左右是设置向外扩散尺寸的，羽化和 VAE 内补编码的遮罩延展一个意思。

![](https://image.uisdc.com/wp-content/uploads/2023/12/uisdc-sd-20231227-8.jpg)

3\. 这个节点是连接在“加载图像”（如果你添加了“图片缩放”节点，那就在这个节点后面）节点和“VAE 内补编码器”节点之间，如下图所示：

![](https://image.uisdc.com/wp-content/uploads/2023/12/uisdc-sd-20231227-9.jpg)

![](https://image.uisdc.com/wp-content/uploads/2023/12/uisdc-sd-20231227-10.jpg)

![](https://image.uisdc.com/wp-content/uploads/2023/12/uisdc-sd-20231227-11.jpg)