# Obsidian 虚拟链接插件（术语表插件）
该插件会自动为笔记中与库内其他笔记标题或别名相匹配的文本生成虚拟链接。


## 功能特点
- 实现类似术语表的功能
- 在**编辑模式**和**阅读模式**下均能正常工作
- 生成的链接**始终保持最新**
- **无需手动创建链接**
- 支持基于笔记的**别名**生成链接
- 链接不会显示在图谱视图中，也不计入引用统计
- 在你扩展笔记库或输入新文本时，自动更新链接
- 可通过右键菜单将虚拟链接转换为真实链接


## 使用演示（真的只是输入文本而已；-）
[![](https://qhdtc.oss-cn-chengdu.aliyuncs.com/obsidian/20250916160458375.gif)](/vschroeter/obsidian-virtual-linker/blob/master/media/LinkerDemo.gif) 
[![](https://github.com/vschroeter/obsidian-virtual-linker/raw/master/media/LinkerDemo.gif)](https://github.com/vschroeter/obsidian-virtual-linker/blob/master/media/LinkerDemo.gif) 


## 使用方法
默认情况下，该插件会自动链接你笔记库中的所有笔记。笔记标题或别名在当前笔记文本中出现的所有位置，都会被转换为链接。如果你只想链接特定文件夹中的笔记，可以在设置中指定该文件夹。

**注意**：自动生成的链接属于后处理内容，既不会将你的笔记文本修改为带方括号的硬编码链接，也不会显示在图谱视图或引用统计中。


## 插件安装


在 Obsidian 中，你可以在“社区插件”标签页中搜索“Virtual Linker”，找到后进行安装，安装完成后在设置中启用该插件即可。

若需手动安装插件，请按以下步骤操作：
1. 将 `main.js` 和 `manifest.json`（可在“Releases”栏目下找到）复制到你的笔记库路径 `VaultFolder/.obsidian/plugins/virtual-linker/` 中。
2. 或者，将该仓库克隆到你笔记库的插件文件夹中，然后自行构建插件。


## 设置
### 匹配文件
你可以在以下两种文件匹配方式之间切换：
- “匹配所有文件”：匹配笔记库中的所有文件。
- “仅匹配特定文件夹中的文件”：仅匹配指定文件夹中的文件。你可以在设置中指定该文件夹，此功能适用于仅想为专用术语表目录中的笔记创建虚拟链接的场景。

此外，你可以通过为文件添加标签，明确包含或排除特定文件，使其参与或不参与匹配。标签可在设置中修改，默认标签如下：
- `linker-include`：明确包含某个文件（使其参与匹配）
- `linker-exclude`：明确排除某个文件（使其不参与匹配）

你也可以在设置的排除列表中添加特定文件夹，从而排除该文件夹中的所有文件。

**注意**：若要包含或排除某个文件或文件夹，可在虚拟链接上或文件资源管理器中通过右键菜单操作。


#### 大小写敏感性
[](#case-sensitivity)

你可以开启或关闭匹配的大小写敏感性，默认情况下不区分大小写。

通常，对于大部分字母为大写的单词，可能需要区分大小写进行匹配。默认情况下，当单词中大写字母占比达到 75% 或以上时，会区分大小写进行匹配，你可以在设置中修改这一阈值。

你也可以通过为特定文件添加标签，明确设置该文件匹配时的大小写敏感性，标签可在设置中修改，默认标签如下：
- `linker-match-case`：设置为区分大小写匹配
- `linker-ignore-case`：设置为不区分大小写匹配

若要为特定别名定义大小写敏感性，可在笔记的前置元数据（frontmatter）中定义属性列表：
- `linker-match-case`：包含需要区分大小写匹配的名称列表
- `linker-ignore-case`：包含不需要区分大小写匹配的名称列表

这些属性名称可在设置中修改。


#### 匹配模式
[](#matching-mode)

##### 禁止重复匹配与对真实链接的匹配
[](#suppress-multiple-matching-and-matching-to-real-links)

默认情况下，插件会禁止在同一份笔记中创建多个相同的虚拟链接。此外，你还可以开启“禁止为当前笔记中已存在真实链接的文件创建虚拟链接”的功能。

##### 部分匹配
[](#part-matching)

你可以在以下几种匹配模式之间切换：
- “仅匹配完整单词”：仅匹配完整的单词。例如，“book”不会匹配“Notebook”。
- “同时匹配单词开头”：匹配单词的开头部分。例如，“book”不会匹配“Notebook”，但“Note”会匹配“Notebook”。
- “匹配单词的任意部分”：匹配单词的任意部分。例如，“book”会匹配“Notebook”。

你还可以选择为这些匹配结果隐藏链接后缀，以避免文本显得杂乱。

##### 指向笔记自身的链接
[](#links-to-the-note-itself)

默认情况下，插件会禁止创建指向笔记自身的链接。不过，这种链接禁止功能可能存在一些漏洞，并非在所有场景下都能生效（例如在预览窗口中）。如果你希望允许创建指向笔记自身的链接，可以在设置中切换这一功能的状态。

##### 当前行的链接禁止
[](#link-suppression-in-current-line)

默认情况下，你在输入文本时会直接创建链接。你可以选择禁止在当前正在输入的行中创建链接。

**注意**：当使用输入法编辑器（IME）输入中文、日文等语言时，建议禁止在当前行创建链接，否则插件可能会干扰输入法的正常工作。


#### 链接样式
[](#styling-of-the-links)

所有生成的虚拟链接都会添加一个后缀，该后缀有助于区分真实链接和虚拟链接，默认后缀为“🔗”。

默认情况下（且当设置中“启用默认样式”选项处于开启状态时），虚拟链接的颜色会比普通链接略深一些。你可以在设置中关闭这一默认样式。

若要为虚拟链接自定义样式，可在 `VaultFolder/.obsidian/snippets/virtualLinks.css` 文件中添加 CSS 代码片段，示例如下：

```css
/* 虚拟链接未悬停时的样式属性 */
.virtual-link.glossary-entry a {
    /* 未悬停时使用普通文本颜色 */
    color: inherit;

    /* 也可自定义颜色，例如红色 */
    /* color: red; */

    /* 还可修改链接下划线的粗细、颜色及其他属性 */
    text-decoration-thickness: 1px; /* 下划线粗细 */
    text-decoration-color: rgb(var(--color-purple-rgb), 0.6); /* 下划线颜色 */
    text-underline-position: under; /* 下划线位置 */
    /* text-decoration-style: dotted; */ /* 下划线样式（点状） */
    /* text-underline-offset: 0em; */ /* 下划线偏移量 */
}

/* 虚拟链接悬停时的样式属性 */
.virtual-link.glossary-entry a:hover {
    color: var(--link-color); /* 悬停时使用默认链接颜色 */
}
```

**注意**：若要应用自定义样式，请务必在设置中关闭“应用默认链接样式”选项。


## 命令
[](#commands)

该插件提供以下可使用的命令：
- **将选中区域内的所有虚拟链接转换为真实链接**：将选中文本内的所有虚拟链接转换为真实链接。
- **激活虚拟链接插件**：若插件当前处于未激活状态，执行该命令可激活插件。
- **停用虚拟链接插件**：若插件当前处于激活状态，执行该命令可停用插件。

你可以在命令面板中调用这些命令，也可以在设置中为它们分配自定义快捷键。


## 右键菜单选项
[](#context-menu-options)

右键点击虚拟链接时，右键菜单中会显示以下选项：
- **转换为真实链接**：将选中的虚拟链接转换为真实链接。
- **排除此文件**：为该文件添加 `linker-exclude` 标签，使其不再被虚拟链接插件匹配。
- **包含此文件**：为该文件添加 `linker-include` 标签，确保其能被虚拟链接插件匹配。


## 开发使用方法


1. 将本仓库克隆到 `your-vault/.obsidian/plugins/` 路径下。
2. 执行 `yarn` 命令安装依赖。
3. 执行 `yarn dev` 命令启动监视模式进行编译。
4. 执行 `yarn build` 命令将 `main.ts` 编译为 `main.js`。

开发时，建议配合使用 [Hot Reload Plugin](https://github.com/pjeby/hot-reload)（热重载插件）。
