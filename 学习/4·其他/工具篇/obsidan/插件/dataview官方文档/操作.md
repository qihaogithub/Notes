数据视图函数提供了更高级的数据操作方法。您可以使用[数据命令](https://blacksmithgu.github.io/obsidian-dataview/queries/data-commands/)中的函数 (FROM 除外)来过滤或分组，或者使用它们作为[附加信息](https://blacksmithgu.github.io/obsidian-dataview/queries/query-types/)，如 TABLE 列或 LIST 查询的额外输出，以便从新的角度看待您的数据。

# 功能是如何工作的

函数是另一种[表达式](https://blacksmithgu.github.io/obsidian-dataview/reference/expressions/)形式，可以在任何可以使用表达式的地方使用。函数总是返回一个新值，并遵循以下格式:

`函数名(参数1, 参数2)` 

参数也是表达式，可以使用文字、元数据字段，甚至另一个函数作为参数。您将在此页的文档中找到您的参数需要具有的[数据类型](https://blacksmithgu.github.io/obsidian-dataview/annotation/types-of-metadata/)。注意函数括号内的信息。方括号中的参数，即 link (path，\[ display \])意味着它们是可选的，可以省略。了解更多关于每个函数的默认行为的解释。

对值列表调用函数
--------

大多数函数可以应用于单个值 (如数字、字符串、日期等) ，也可以应用于这些值的列表。如果将函数应用于列表，则在将函数应用于列表中的每个元素之后，它还将返回一个列表。例如:

```
lower("YES") = "yes" 
lower(["YES", "NO"]) = ["yes", "no"] 
replace("yes", "e", "a") = "yas" 
replace(["yes", "ree"], "e", "a") = ["yas", "raa"]
```


这种所谓的“函数向量化”不会在下面的定义中明确提到，而是可以隐式地用于这些功能的广泛范围。

建筑工人
----

创建值的构造函数。

### Object (key 1，value 1，...)

创建具有给定键和值的新对象。键和值应该在调用中交替，键应该始终是字符串/文本。

```
object() => empty object 
object("a", 6) => object which maps "a" to 6 
object("a", 4, "c", "yes") => object which maps a to 4, and c to "yes"
```

### 列表 (value 1，value 2，...)

创建一个包含给定值的新列表。

`list()  =>  empty  list
List (1,  2,  3)  =>  list  with  1,  2,  and  3
list ("a",  "b",  "c")  =>  list  with  "a",  "b",  and  "c"` 

### 日期 (任何日期)

如果可能，从提供的字符串、日期或链接对象中分析日期，否则返回 null。

`date("2020-04-18")  =  <date  object  representing  April  18th,  2020>
date ([[2021-04-16]])  =  <date  object  for  the  given  page,  referring  to  file.day>` 

### 日期 (文字，格式)

使用指定的格式将日期从文本解析为 luconDateTime。注意本地化格式可能不起作用。用的是 Luxon 代币。

`date("12/31/2022",  "MM/dd/yyyy")  =>  DateTime  for  Decemeber  31th,  2022
Date ("210313",  "yyMMdd")  =>  DateTime  for  March  13 th,  2021
date ("946778645000",  "x")  =>  DateTime  for  "2000-01-02 T 03:04:05"` 

### 硬 (任何)

从提供的字符串或持续时间解析持续时间，失败时返回 null。

`dur(8  minutes)  =  <8  minutes>
dur ("8 minutes, 4 seconds")  =  <8  minutes,  4  seconds>
dur (dur (8  minutes))  =  dur (8  minutes)  =  <8  minutes>` 

### 数字 (字符串)

从给定的字符串中提取第一个数字，如果可能的话返回它。如果字符串中没有数字，则返回空。

`number("18 years")  =  18
Number (34)  =  34
number ("hmm")  =  null ` 

### 字符串 (任何)

将任何值转换为“合理的”字符串表示形式。与直接在查询中使用值相比，这有时会产生不那么漂亮的结果——它主要用于将日期、持续时间、数字等强制转换为字符串以进行操作。

`string(18)  =  "18"
String (dur (8  hours))  =  "8 hours"
string (date (2021-08-15))  =  "August 15 th, 2021"` 

### 链接 (路径，\[显示\])

从给定的文件路径或名称构造链接对象。如果提供了两个参数，则第二个参数是链接的显示名称。

`link("Hello")  =>  link  to  page  named  'Hello'
link ("Hello",  "Goodbye")  =>  link  to  page  named  'Hello',  displays  as  'Goodbye' ` 

### 嵌入 (链接，\[嵌入? \])

将 link 对象转换为嵌入式链接，对嵌入式链接的支持在 Dataview 视图中有些参差不齐，不过嵌入图像应该可以。

`embed(link("Hello.png"))  =>  embedded  link  to  the  "Hello.png"  image,  which  will  render  as  an  actual  image.` 

### 链接 (url，\[ display \])

建立一个到外部网址的链接 (比如 www.google.com )。如果提供了两个参数，则第二个参数是链接的显示名称。

`elink("www.google.com")  =>  link  element  to  google.com
elink (" www.google.com" ,  "Google")  =>  link  element  to  google. Com,  displays  as  "Google"` 

### 类别 (任何类别)

获取用于检查的任何对象的类型。可以与其他运算符一起使用，以根据类型更改行为。

`typeof(8)  =>  "number"
Typeof ("text")  =>  "string"
Typeof ([1,  2,  3])  =>  "array"
Typeof ({  a:  1,  b:  2  })  =>  "object"
Typeof (date (2020-01-01))  =>  "date"
typeof (dur (8  minutes))  =>  "duration"` 

* * *

数字操作
----

### 四舍五入 (数字，\[数位\])

把一个数字四舍五入到一个给定的数字。如果未指定第二个参数，则四舍五入到最接近的整数; 否则，四舍五入到给定的数位数。

`round(16.555555)  =  7
round (16.555555,  2)  =  16.56 ` 

### Trunc (number)

从一个数字中截去小数点。

`trunc(12.937)  =  12
Trunc (-93.33333)  =  -93
trunc (-0.837764)  =  0 ` 

### 楼层 (号码)

总是向下舍入并返回小于或等于给定数字的最大整数。这意味着负数变得更加负数。

`floor(12.937)  =  12
Floor (-93.33333)  =  -94
floor (-0.837764)  =  -1 ` 

### 天线 (号码)

总是四舍五入并返回大于或等于给定数字的最小整数。这意味着负数变得不那么负了。

`ceil(12.937)  =  13
Ceil (-93.33333)  =  -93
ceil (-0.837764)  =  0 ` 

### Min (a，b，. .)

计算参数列表或数组的最小值。

`min(1,  2,  3)  =  1
Min ([1,  2,  3])  =  1

min ("a",  "ab",  "abc")  =  "a"` 

### 最大 (a，b，...)

计算参数列表或数组的最大值。

`max(1,  2,  3)  =  3
Max ([1,  2,  3])  =  3

max ("a",  "ab",  "abc")  =  "abc"` 

### Sum (array)和 (数组)

对数组中的所有数值求和。如果平均值中有空值，可以通过非空函数消除它们。

`sum([1,  2,  3])  =  6
Sum ([])  =  null

sum (nonnull ([null,  1,  8]))  =  9 ` 

### 产品 (数组)

计算数字列表的乘积。如果平均值中有空值，可以通过非空函数消除它们。

`product([1,2,3])  =  6
Product ([])  =  null

product (nonnull ([null,  1,  2,  4]))  =  8 ` 

### 平均值 (数组)

计算数值的数值平均值。如果平均值中有空值，可以通过非空函数消除它们。

`average([1,  2,  3])  =  2
Average ([])  =  null

average (nonnull ([null,  1,  2]))  =  1.5 ` 

### Minby (数组，函数)

使用提供的函数计算数组的最小值。

`minby([1,  2,  3],  (k)  =>  k)  =  1
Minby ([1,  2,  3],  (k)  =>  0  -  k)  =>  3

minby (this. File. Tasks,  (k)  =>  k.due)  =>  (earliest  due) ` 

### Maxby (array，function)

使用提供的函数计算数组的最大值。

`maxby([1,  2,  3],  (k)  =>  k)  =  3
Maxby ([1,  2,  3],  (k)  =>  0  -  k)  =>  1

maxby (this. File. Tasks,  (k)  =>  k.due)  =>  (latest  due) ` 

--

对象、数组和字符串运算
-----------

操作容器对象内部的值的操作。

### 包含 ()和朋友

作为一个快速的总结，这里有一些例子:

`contains("Hello",  "Lo")  =  false
Contains ("Hello",  "lo")  =  true

Icontains ("Hello",  "Lo")  =  true
Icontains ("Hello",  "lo")  =  true

Econtains ("Hello",  "Lo")  =  false
Econtains ("Hello",  "lo")  =  true
Econtains (["this","is","example"],  "ex")  =  false
econtains (["this","is","example"],  "is")  =  true ` 

#### 包含 (object | list | string，value)

检查给定容器类型中是否包含给定值。根据第一个参数是对象、列表还是字符串，此函数的行为略有不同。此函数区分大小写。

*   对于对象，检查对象是否具有具有给定名称的键,
    
    `contains(file, "ctime") = true
    contains (file, "day") = true (if file has a date in its title, false otherwise) ` 
    
*   对于列表，检查是否有任何数组元素等于给定的值,
    
    `contains(list(1, 2, 3), 3) = true
    contains (list (), 1) = false ` 
    
*   对于字符串，检查给定的值是否是字符串的子字符串 (例如，在字符串内部)。
    
    `contains("hello", "lo") = true
    contains ("yes", "no") = false ` 
    

#### 图标 (object | list | string，value)

包含 ()的不区分大小写版本。

#### 包含 (object | list | string，value)

“ Exact include”检查在字符串/列表中是否找到了完全匹配。

*   对于字符串，它的行为完全类似于 include ()。
    
    `econtains("Hello", "Lo") = false
    econtains ("Hello", "lo") = true ` 
    
*   对于列表，它检查列表中是否包含确切的单词。
    
    `econtains(["These", "are", "words"], "word") = false
    econtains (["These", "are", "words"], "words") = true ` 
    
*   对于对象，它检查对象中是否存在确切的键名，而不执行递归检查。
    
    `econtains({key:"value", pairs:"here"}, "here") = false
    Econtains ({key: "value", pairs: "here"}, "key") = true
    Econtains ({key: "value", recur:{recurkey: "val"}}, "value") = false
    Econtains ({key: "value", recur:{recurkey: "val"}}, "Recur") = false
    econtains ({key: "value", recur:{recurkey: "val"}}, "recurkey") = false ` 
    

### 包含值 (list | string，value)

检查 value 在字符串或列表中是否有精确的单词匹配。这是不区分大小写的。对于不同类型的输入，输出是不同的，请参阅示例。

*   对于字符串，它检查给定字符串中是否存在单词。
    
    `containsword("word", "word") = true
    Containsword ("word", "Word") = true
    Containsword ("words", "Word") = false
    Containsword ("Hello there!, "hello") = true
    Containsword ("Hello there!, "HeLLo") = true
    Containsword ("Hello there chaps!, "chap") = false
    containsword ("Hello there chaps!, "chaps") = true ` 
    
*   对于列表，它返回一个布尔值列表，指示是否找到了单词的大小写不敏感匹配。
    
    `containsword(["I have no words.", "words"], "Word") = [false, false]
    Containsword (["word", "Words"], "Word") = [true, false]
    containsword (["Word", "Words in word"], "WORD") = [true, true]` 
    

从一个对象中提取多个字段，仅使用这些字段创建一个新对象。

`extract(file, "ctime", "mtime") = object("ctime", file.ctime, "mtime", file.mtime)
extract (object ("test", 1)) = object () ` 

### 分类 (列表)

对列表进行排序，并按排序顺序返回新列表。

`sort(list(3, 2, 1)) = list(1, 2, 3)
sort (list ("a", "b", "aa")) = list ("a", "aa", "b") ` 

### 反向 (列表)

反向列表，以反向顺序返回新列表。

`reverse(list(1, 2, 3)) = list(3, 2, 1)
reverse (list ("a", "b", "c")) = list ("c", "b", "a") ` 

### 长度 (对象 | 数组)

返回对象中的字段数或数组中的条目数。

`length([]) = 0
Length ([1, 2, 3]) = 3
length (object ("hello", 1, "goodbye", 2)) = 2 ` 

### 非空 (数组)

返回一个删除了所有空值的新数组。

`nonnull([]) = []
Nonnull ([null, false]) = [false]
nonnull ([1, 2, 3]) = [1, 2, 3]` 

### 所有 (数组)

仅当数组中的所有值为 true 时才返回 true。还可以向该函数传递多个参数，在这种情况下，只有当所有参数为真时，该函数才返回 true。

`all([1, 2, 3]) = true
All ([true, false]) = false
All (true, false) = false
all (true, true, true) = true ` 

可以将函数作为第二个参数传递，以便在数组中的所有元素都匹配谓词时仅返回 true。

`all([1, 2, 3], (x) => x > 0) = true
All ([1, 2, 3], (x) => x > 1) = false
all (["apple", "pie", 3], (x) => typeof (x) = "string") = false ` 

### 任何 (数组)

如果数组中的任何值为真，则返回 true。还可以向该函数传递多个参数，在这种情况下，如果任何参数为真，则返回 true。

`any(list(1, 2, 3)) = true
Any (list (true, false)) = true
Any (list (false, false, false)) = false
Any (true, false) = true
any (false, false) = false ` 

可以将函数作为第二个参数传递，以便在数组中的任何元素与谓词匹配时仅返回 true。

`any(list(1, 2, 3), (x) => x > 2) = true
any (list (1, 2, 3), (x) => x = 0) = false ` 

### 无 (数组)

如果数组中没有值为真，则返回 true。

`none([]) = true
None ([false, false]) = true
None ([false, true]) = false
none ([1, 2, 3]) = false ` 

可以将函数作为第二个参数传递，以便在数组中没有任何元素与谓词匹配时仅返回 true。

`none([1, 2, 3], (x) => x = 0) = true
None ([true, true], (x) => x = false) = true
none (["Apple", "Pi", "Banana"], (x) => startswith (x, "A")) = false ` 

### Join (array，\[ delimiter \])

将数组中的元素连接到一个字符串中 (即，在同一行中呈现所有元素)。如果提供了第二个参数，那么每个元素将由给定的分隔符分隔。

`join(list(1, 2, 3)) = "1, 2, 3"
Join (list (1, 2, 3), " ") = "1 2 3"
Join (6) = "6"
join (list ()) = ""` 

### Filter (array，谓词)

根据谓词过滤数组中的元素，返回匹配的元素的新列表。

`filter([1,  2,  3],  (x)  =>  x  >=  2)  =  [2,  3]
filter (["yes",  "no",  "yas"],  (x)  =>  startswith (x,  "y"))  =  ["yes",  "yas"]` 

### Map (array，func)

将函数应用于数组中的每个元素，并返回映射结果的列表。

`map([1,  2,  3],  (x)  =>  x  +  2)  =  [3,  4,  5]
map (["yes",  "no"],  (x)  =>  x  +  "?")  =  ["yes?",  "no?"]` 

### 平 (数组，\[深度\])

将数组的子级连接到所需的深度。默认为 1 级，但它可以连接多个级别。例如，在执行 GROUPBY 之后，可以用于减少行列表上的数组深度。

`flat(list(1,  2,  3,  list(4,  5),  6))  =>  list(1,  2,  3,  4,  5,  6)
Flat (list (1,  list (21,  22),  list (list  (311,  312,  313))),  4)  =>  list (1,  21,  22,  311,  312,  313)
flat (rows. File. Outlinks))  =>  All  the  file  outlinks  at  first  level  in  output ` 

* * *

字符串运算
-----

### Regextest (模式，字符串)

检查给定的正则表达式模式是否可以在字符串中找到 (使用 JavaScriptregex 引擎)。

`regextest("\w+",  "hello")  =  true
Regextest (".",  "a")  =  true
Regextest ("yes|no",  "maybe")  =  false
regextest ("what",  "what's up dog?")  =  true ` 

### Regexmatch (模式，字符串)

使用 JavaScriptregex 引擎检查给定的 regex 模式是否匹配整个字符串。这与 regextest 的不同之处在于，regextest 只能匹配文本的一部分。

`regexmatch("\w+",  "hello")  =  true
Regexmatch (".",  "a")  =  true
Regexmatch ("yes|no",  "maybe")  =  false
regexmatch ("what",  "what's up dog?")  =  false ` 

### Regexplace (字符串、模式、替换)

用替换替换正则表达式模式在字符串中匹配的所有实例。这使用了底层的 JavaScript 替换方法，因此您可以使用特殊字符，比如 $1 来引用第一个捕获组，等等。

`regexreplace("yes",  "[ys]",  "a")  =  "aea"
regexreplace ("Suite 1000",  "\d+",  "-")  =  "Suite -"` 

### 替换 (字符串，模式，替换)

用替换替换字符串中的所有模式实例。

`replace("what",  "wh",  "h")  =  "hat"
Replace ("The big dog chased the big cat.",  "big",  "small")  =  "The small dog chased the small cat."
replace ("test",  "test",  "no")  =  "no"` 

### 下 (弦)

将字符串转换为所有小写。

`lower("Test")  =  "test"
lower ("TEST")  =  "test"` 

### 上 (弦)

将字符串转换为所有大写。

`upper("Test")  =  "TEST"
upper ("test")  =  "TEST"` 

### 拆分 (字符串、分隔符、\[限制\])

拆分给定分隔符字符串上的字符串。如果提供了第三个参数，它将限制发生拆分的次数。分隔符字符串被解释为正则表达式。如果分隔符中有捕获组，则匹配将拼接到结果数组中，不匹配的捕获是空字符串。

`split("hello world",  " ")  =  list("hello",  "world")
Split ("hello  world",  "\s")  =  list ("hello",  "world")
Split ("hello there world",  " ",  2)  =  list ("hello",  "there")
Split ("hello there world",  " (t? Here)")  =  list ("hello ",  "there",  " world")
split ("hello there world",  " ( )(x)?")  =  list ("hello",  " ",  "",  "there",  " ",  "",  "world") ` 

### 以 (字符串，前缀)开头

检查字符串是否以给定的前缀开头。

`startswith("yes",  "ye")  =  true
Startswith ("path/to/something",  "path/")  =  true
startswith ("yes",  "no")  =  false ` 

### Endswith (字符串，后缀)

检查字符串是否以给定的后缀结束。

`endswith("yes",  "es")  =  true
Endswith ("path/to/something",  "something")  =  true
endswith ("yes",  "ye")  =  false ` 

### Padleft (字符串、长度、\[填充\])

通过在字符串的左侧添加填充，将字符串填充到所需的长度。如果省略填充字符，则默认情况下将使用空格。

`padleft("hello",  7)  =  "  hello"
padleft ("yes",  5,  "!")  =  "!! Yes"` 

### Padright (字符串、长度、\[填充\])

相当于向左填充，但是向右填充。

`padright("hello",  7)  =  "hello  "
padright ("yes",  5,  "!")  =  "yes!!"` 

### Substring (string，start，\[ end \])

取一段字符串，从开始到结束 (如果没有指定，字符串的结尾)。

`substring("hello",  0,  2)  =  "he"
Substring ("hello",  2,  4)  =  "ll"
Substring ("hello",  2)  =  "llo"
substring ("hello",  0)  =  "hello"` 

### 截断 (string，length，\[后缀\])

截断一个最大长度的字符串，包括后缀 (默认为...)。一般用于切断表格中的长文本。

`truncate("Hello there!",  8)  =  "Hello..."
Truncate ("Hello there!",  8,  "/")  =  "Hello t/"
truncate ("Hello there!",  10)  =  "Hello t..."
Truncate ("Hello there!",  10,  "!")  =  "Hello the!"
truncate ("Hello there!",  20)  =  "Hello there!"` 

公用事业职能
------

### Default (字段，值)

如果 field 为 null，则返回 value; 否则返回 field。用默认值替换空值很有用。例如，要显示尚未完成的项目，使用“不完整”作为默认值:

`default (dateCompleted,  "incomplete")` 

默认值在两个参数中都是向量化的; 如果需要在列表参数上显式使用 Default，那么使用 ldefault，它与 Default 相同，但不是向量化的。

`default (list (1,  2,  null),  3)  =  list (1,  2,  3)
Ldefault (list (1,  2,  null),  3)  =  list (1,  2,  null)` 

### 选择 (布尔，左，右)

原语 if 语句-如果第一个参数为 true，则返回 left; 否则返回 right。

`choice (true,  "yes",  "no")  =  "yes"
Choice (false,  "yes",  "no")  =  "no"
Choice (x  >  4,  y,  z)  =  y  if  x  >  4,  else  z` 

### 脱衣时间 (日期)

去掉日期的时间部分，只留下年、月和日。如果你不在乎时间的话，可以很好的进行日期比较。

`striptime (file. Ctime)  =  file. Cday
Striptime (file. Mtime)  =  file. Mday` 

### `dateformat (date|datetime, string)`

Format a Dataview date using a formatting string. Uses [Luxon tokens](https://moment.github.io/luxon/#/formatting?id=table-of-tokens).

`dateformat (file. Ctime,"yyyy-MM-dd")  =  "2022-01-05"
dateformat (file. Ctime,"HH:mm: ss")  =  "12:18:04"
Dateformat (date (now),"x")  =  "1407287224054"
dateformat (file. Mtime,"ffff")  =  "Wednesday, August 6, 2014, 1:07 PM Eastern Daylight Time"` 

### Durationformat (持续时间，字符串)

使用格式化字符串设置数据视图持续时间的格式。单引号中的任何内容都不会作为令牌处理，而是按照写入的方式显示在输出中。看看例子。

您可以使用以下标记:

*   S 表示毫秒
*   几秒钟
*   几分钟
*   几个小时
*   好几天了
*   好几周了
*   好几个月了
*   很多年了

`durationformat (dur ("3 days 7 hours 43 seconds"),  "ddd'd' hh'h' ss's'")  =  "003 d 07 h 43 s"
Durationformat (dur ("365 days 5 hours 49 minutes"),  "yyyy ddd hh mm ss")  =  "0001 000 05 49 00"
Durationformat (dur ("2000 years"),  "M months")  =  "24000 months"
Durationformat (dur ("14 d"),  "s 'seconds'")  =  "1209600 seconds"` 

### 本地时间 (日期)

将固定时区内的日期转换为当前时区内的日期。

### Meta (链接)

获取包含链接元数据的对象。当访问链接上的属性时，从链接文件返回的是属性值。Meta 函数使访问链接本身的属性成为可能。

Meta 返回的对象有几个属性:

#### 显示

获取链接的显示文本，如果链接没有定义的显示文本，则为 null。

`meta ([[2021-11-01|Displayed  link  text]]). Display  =  "Displayed link text"
meta ([[2021-11-01]]). Display  =  null` 

#### 元 (链接)。嵌入

真或假取决于链接是否是嵌入的。这些链接都是以叹号开头的！\[一些链接\]。

#### 路径

获取链接的路径部分。

`meta ([[My  Project]]). Path  =  "My Project"
meta ([[My  Project#Next  Actions]]). Path  =  "My Project"
meta ([[My  Project#^9bcbe8]]). Path  =  "My Project"` 

#### 子路径

获取链接的子路径。对于指向文件内标题的链接，子路径将是标题的文本。对于指向块的链接，子路径将是块 ID。如果这两种情况都不适用，那么子路径将为空。

`meta ([[My  Project#Next  Actions]]). Subpath  =  "Next Actions"
meta ([[My  Project#^9bcbe8]]). Subpath  =  "9 bcbe 8"
meta ([[My  Project]]). Subpath  =  null` 

这可用于选择特定标题下的任务。

` ```dataview
Task
Where meta (section). Subpath = "Next Actions"
``` ` 

#### 类型

具有值“ file”、“ header”或“ block”，具体取决于链接是链接到整个文件、文件中的标题还是链接到文件中的块。

`meta ([[My  Project]]). Type  =  "file"
meta ([[My  Project#Next  Actions]]). Type  =  "header"
meta ([[My  Project#^9bcbe8]]). Type  =  "block"`